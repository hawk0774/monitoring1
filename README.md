# 13.Системы мониторинга

## Задание 1

Мониторинг по оценке работоспособности ПО

Мониторинг общего количества (http/https) запросов к данному приложению
Количество неудачных ответов пользователям (ошибки 400/404)
Доступность ПО из различных регионов (при необходимости)
Мониторинг по оценке работоспособности оборудования

CPU
Общая загрузка ЦПУ
Часть нагрузки ЦПУ оказываемой непосредственно приложением, или каким либо важным рабочим процессом данного приложения
RAM
Количество занятой и оставшейся памяти
HDD
Нагрузка на диск
Остаточная ёмкость
Состояние диска (smart)
График заполняемости свободного места на диске
LAN
Количество проходящего трафика
Бизнес мониторинг

Количество успешно выданных отчетов
Количество неудачных отчетов
Количество отчетов в работе
Мониторинг среднего времени формирования отчетов
Мониторинг безопасности ИС

Нестандартное количество попыток авторизаций пользователя в промежуток времени, при отсутствии временного ограничения после нескольких неудачных авторизаций пользователя.
Актуальность существующих сертификатов.
Нестандартное количество запросов на формирование отчетов от одного пользователя в промежуток времени.
Если приложение используется в пределах страны, тогда можно отслеживать трафик приходящий из нестандартных регионов.

## Задание 2

Менеджер продукта посмотрев на ваши метрики сказал, что ему непонятно что такое RAM/inodes/CPUla. Также он сказал, что хочет понимать, насколько мы выполняем свои обязанности перед клиентами и какое качество обслуживания. Что вы можете ему предложить?

Ответ
RAM - количество занятой и оставшейся памяти
inodes - количество индексных дискрипторов, их переполнения приведет к невозможности создания новых файлов
CPUla - нагрузка на процессор
Для того чтобы привести метрики в более простой и читаемый вид для менеджеров, необходимо утвердить SLA в рамках которого будут указаны SLO для тех или иных метрик. После чего менеджерам будет проще ориентироваться в состоянии продукта, так как их будут интересовать только разницы значений SLO и SLI. Если значения SLI той или иной метрики не противоречат установленным для неё SLO тогда проект в норме. Это позволяет менеджеру не знать для чего та или иная метрика, но позволяет им сложить общую картину состояния работоспособности проекта.

## Задание 3

Вашей DevOps команде в этом году не выделили финансирование на построение системы сбора логов. Разработчики в свою очередь хотят видеть все ошибки, которые выдают их приложения. Какое решение вы можете предпринять в этой ситуации, чтобы разработчики получали ошибки приложения?

Ответ
В основном все варианты отслеживания ошибок в логах упираются в возможности и бюджет.

Если приложение маленькое и нагрузка не высока, тогда можно использовать скрипты для вытягивания ошибок, к примеру по ключевым словам.
Если приложение более востребовано и бюджеты позволяют приобрести мощности, тогда лучше воспользоваться специализированным ПО типа Sentry и др.

## Задание 4

ы, как опытный SRE, сделали мониторинг, куда вывели отображения выполнения SLA=99% по http кодам ответов. Вычисляете этот параметр по следующей формуле: summ_2xx_requests/summ_all_requests. Данный параметр не поднимается выше 70%, но при этом в вашей системе нет кодов ответа 5xx и 4xx. Где у вас ошибка?

Ответ
В формуле из задания не используются значения кодов 1xx и 3xx

Правильный вариант формулы будет выглядеть так:
SLI = (summ_2xx_requests + summ_3xx_requests + summ_1xx_requests)/(summ_all_requests)

## Задание 5

Push модель:
Плюсы:

Настройка точек приёма метрик осуществляется на агентах, что позволяет настроить вывод метрик в несколько систем мониторирования и возможность реализовать репликацию;
UDP является менее затратным способом передачи данных, вследствие чего может вырасти производительность сбора метрик;
Работает за NAT;
Более гибкая настройка отправки пакетов данных с метриками. На каждом клиенте можно задать нужный нам объем данных и частоту отправки.
Минусы:

Затрудняется верификация данных в системах мониторинга. Эмулируя действия агента, можно размыть данные мониторинга ложной информацией;
Агенты могут зафлудить сервера запросами спровоцировав DDoS;
Протокол UDP не гарантирует доставку данных.
Pull модель
Плюсы:

Легче контролировать подлинность данных. Есть гарантия опроса только тех агентов, которые настроены в системе мониторинга;
Упрощенная отладка получения данных с агентов. Так как данные запрашиваются посредством HTTP, можно самостоятельно запрашивать эти данные, используя ПО вне системы мониторинга;
Сервер собирает данные с агентов когда может, и если в данный момент нет свободных ресурсов - заберёт данные позже;
Безопасность при pull-модели гораздо выше. Не требует открытия порта сервера во вне. Проще защитить трафик, т.к. часто используется HTTP/S
Минусы:

Более высокие требования к ресурсам, особенно при использовании защищённых каналов связи;
Не работает за NAT. Надо ставить какой-нибудь прокси.

## Задание 6
Prometheus	Pull (Push с Pushgateway)
TICK	Push
Zabbix	Push (Pull с Zabbix Proxy)
VictoriaMetrics	Push/Pull, зависит от источника
Nagios	Pull
